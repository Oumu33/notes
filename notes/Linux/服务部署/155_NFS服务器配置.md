# NFS服务器配置
<font style="color:#000000;"></font>

# 一、实验目的
1.  掌握缓存DNS服务配置

# 二、实验内容
1.  构建两台web服务器，搭建基于LAMP架构的Discuz论坛，客户随机访问两台web服务器内容完全一致

# 三、实验环境
1.  Web1服务器centos7对应主机ip为10.10.64.193

2.  Web2服务器centos7对应主机ip为10.10.64.192

3.  Nfs、数据库服务器centos7对应主机ip为10.10.64.190

# 四、实验分析与设计思路
1.   网络拓扑图

![](https://via.placeholder.com/800x600?text=Image+4642e69206991780)

2.   实验思路

![](https://via.placeholder.com/800x600?text=Image+efa6d01c0d2ab4d4)

# 五、实验准备
1.   设置环境为同一网段，连接公网，DHCP获取ip

2.   关闭所有主机防火墙

3.   测试网络连通性

# 六、软件安装
1.   Web1服务器安装httpd、php、其他组件

![](https://via.placeholder.com/800x600?text=Image+c2f4241e28b732a5)

![](https://via.placeholder.com/800x600?text=Image+dfd3a50b7d3960d3)

2.   Web2服务器安装httpd、php、其他组件

![](https://via.placeholder.com/800x600?text=Image+c2f4241e28b732a5)

![](https://via.placeholder.com/800x600?text=Image+dfd3a50b7d3960d3)

3.   nsf、数据库服务器安装mysql、nfs、其他组件

![](https://via.placeholder.com/800x600?text=Image+13af0585dfdfd684)

# 七、lamp架构搭建测试
1.   Httpd测试

①   开启主机名

![](https://via.placeholder.com/800x600?text=Image+24508604bb0f3197)

 

②   编写测试页

![](https://via.placeholder.com/800x600?text=Image+0a8329aa26986c58)

③   访问测试

![](https://via.placeholder.com/800x600?text=Image+8f42dd743b529fd3)

## 2.   Php测试
①   查看php和httpd的勾连

![](https://via.placeholder.com/800x600?text=Image+66f704fca54d8258)

②   修改httpd主配置文件，让索引页支持php

![](https://via.placeholder.com/800x600?text=Image+fcf23ae28f259488)

③   编写PHP测试页，验证php和httpd的勾连

![](https://via.placeholder.com/800x600?text=Image+1ce54d44b9945e1f)

![](https://via.placeholder.com/800x600?text=Image+12a53d50b9057b1e)

④   浏览器验证

![](https://via.placeholder.com/800x600?text=Image+eec6532b940574fa)

## 3.   Mysql测试
①   修改主配置文件

![](https://via.placeholder.com/800x600?text=Image+5fbb9177f5c8ffba)

②   启动mariadb服务

![](https://via.placeholder.com/800x600?text=Image+6e86aae02aab7953)

③   删除用户名为空的账号

![](https://via.placeholder.com/800x600?text=Image+925b8f16a4696c8f)

④   修改数据库用户密码

![](https://via.placeholder.com/800x600?text=Image+16457157846d8863)

⑤   授权远程登录用户

![](https://via.placeholder.com/800x600?text=Image+ac9da52b1f2695aa)

⑥   Web服务器连接测试

![](https://via.placeholder.com/800x600?text=Image+93dad64359e909c4)

⑦   编写数据库测试页

![](https://via.placeholder.com/800x600?text=Image+96d4c2c5fc69ff1d)

![](https://via.placeholder.com/800x600?text=Image+98da920cb228d483)

⑧   访问验证

![](https://via.placeholder.com/800x600?text=Image+f60facf312bd6e1e)

# 八、Nfs搭建配置
## 1.   Nfs部署
①   启动服务

![](https://via.placeholder.com/800x600?text=Image+ae5c952fb0c13673)

②   编辑/etc/exports配置文件

![](https://via.placeholder.com/800x600?text=Image+cdaca6b45654ed2f)

l  ①rw    指定的主机可读、可写

l  ②ro    指定的主机仅可读

l  ③async  异步访问 （这个选项可以改进性能，如果没有完全关闭NFS守护进程重启NFS服务器，可能会造成数据丢失，可不加）

l  ④root_squash：挤压root用户权限（默认开启的选项）

l  ⑤all_squash：挤压所有用户权限

③   创建nfs目录

![](https://via.placeholder.com/800x600?text=Image+b65d3d5529e27637)

④   Web服务器端查询是否可以挂载

![](https://via.placeholder.com/800x600?text=Image+50cd499c7d5851b6)

⑤   Web服务器挂载nfs目录

![](https://via.placeholder.com/800x600?text=Image+c4a941b9a233dde0)

⑥   Web服务器验证

![](https://via.placeholder.com/800x600?text=Image+522ddd8874a18ed0)

![](https://via.placeholder.com/800x600?text=Image+9d74e8d762f24e29)

⑦   设置开机自动挂载

![](https://via.placeholder.com/800x600?text=Image+88ee390e2eb9b606)

![](https://via.placeholder.com/800x600?text=Image+8edee889f3c3ce51)

## 2.   修改web网站文件路径
![](https://via.placeholder.com/800x600?text=Image+b71e0c3aa4a1de26)

![](https://via.placeholder.com/800x600?text=Image+b9f5166f8d2d1b4f)

# 九、项目上线
## 1.   数据库配置
①   创建论坛数据表

![](https://via.placeholder.com/800x600?text=Image+dc5ee2e38cdc1eff)

②   创建论坛管理员用户

![](https://via.placeholder.com/800x600?text=Image+eb0be4e9248b81d2)

## 2.   php配置
①   配置php配置文件，使其支持短格式选项

![](https://via.placeholder.com/800x600?text=Image+45b71ed57d84fc1f)

![](https://via.placeholder.com/800x600?text=Image+c4cc5c3eb133dd5b)

## 3.   论坛其他相关配置
![](https://via.placeholder.com/800x600?text=Image+3324caecea78d1a2)

## 4.   进行验证
![](https://via.placeholder.com/800x600?text=Image+b02084ff9e5ce757)

![](https://via.placeholder.com/800x600?text=Image+e802487ce280da01)


