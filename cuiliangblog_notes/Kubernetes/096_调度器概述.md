# 调度器概述
# 一、概述


1. 目标：基于资源可用性将各Pod资源公平地分布于集群节点之上。
2. 若预选后不存在任何一个满足条件的节点，则Pod被置于Pending状态，直到至少有一个节点可用为止
3. 除了 kubernetes自带的调度器，你也可以编写自己的调度器。通过spec:schedulername参数指定调度器的名字，可以为pod 选择某个调度器进行调度。



# 二、调度过程


1. 调度步骤：节点预选（Predicate）、节点优先级排序（Priority） 、节点择优
+ 节点预选：基于一系列预选规则对每个节点进行检查，将那些不符合条件的节点过滤掉从而完成节点预选。
+ 节点优先排序：对预选出的节点进行优先级排序，以便选出最适合运行Pod对象的节点
+ 节点择优：从优先级排序结果中挑出优先级最高的节点运行Pod对象，当此类节点多于一个时，则从中随机选择一个。
2. 节点预选有一系列的算法可以使用：
+ PodFitsResources：节点上剩余的资源是否大于 pod 请求的资源
+ PodFitsHost：如果 pod 指定了 NodeName，检查节点名称是否和 NodeName匹配PodFitsHost
+ Ports：节点上已经使用的 port 是否和 pod 申请的 port 冲突
+ PodSelectorMatches：过滤掉和 pod 指定的 label 不匹配的节点
+ NoDiskConflict：已经 mount 的 volume 和 pod 指定的 volume不冲突，除非它们都是只读
3. priorities  
过程：按照优先级大小对节点排序优先级由一系列键值对组成，键是该优先级项的名称，值是它的权重（该项的重要性）。这些优先级选项包括：
+ LeastRequestedPriority：通过计算 CPU 和 Memory的使用率来决定权重，使用率越低权重越高。换句话说，这个优先级指标倾向于资源使用比例更低的节点
+ BalancedResourceAllocation：节点上 CPU 和 Memory使用率越接近，权重越高。这个应该和上面的一起使用，不应该单独使用
+ ImageLocalityPriority：倾向于已经有要使用镜像的节点，镜像总大小值越大，权重越高通过算法对所有的优先级项目和权重进行计算，得出最终的结果


