# 请求对象

> 来源: Python
> 创建时间: 2021-03-14T16:49:09+08:00
> 更新时间: 2026-01-11T09:25:39.723946+08:00
> 阅读量: 623 | 点赞: 0

---

## 一、Request objects
1. REST framework 传入视图的request对象不再是Django默认的HttpRequest对象，而是REST framework提供的扩展了HttpRequest类的**Request**类的对象。REST framework 提供了**Parser**解析器，在接收到请求后会自动根据Content-Type指明的请求数据类型（如JSON、表单等）将请求数据进行parse解析，解析为类字典对象保存到**Request**对象中
2. **Request对象的数据是自动根据前端发送数据的格式进行解析之后的结果。**无论前端发送的哪种格式的数据，我们都可以以统一的方式读取数据。

## 二、常用属性
### 1. request.data
返回解析之后的请求体数据。类似于Django中标准的`request.POST`和 `request.FILES`属性，但提供如下特性：

+ 包含了解析之后的文件和非文件数据
+ 包含了对POST、PUT、PATCH请求方式解析后的数据
+ 利用了REST framework的parsers解析器，不仅支持表单类型数据，也支持JSON数据

### 2. request.query_params
与Django标准的`request.GET`相同，只是更换了更正确的名称而已。

### 3. 总结
+ GET请求：如果想获取GET请求的所有参数，使用request.query_params即可
+ POST请求：使用<font style="color:#333333;">request.data就可以处理传入的json请求，或者其他格式请求。</font>

## <font style="color:#333333;">三、使用示例</font>
```python
from django.http import HttpResponse
from rest_framework.renderers import JSONRenderer

from quickstart.models import BookInfo
from quickstart.serializers import BookInfoSerializer
from rest_framework.decorators import api_view


class JSONResponse(HttpResponse):
    """
    将内容渲染成JSON的HttpResponse
    """

    def __init__(self, data, **kwargs):
        content = JSONRenderer().render(data)
        kwargs['content_type'] = 'application/json'
        super(JSONResponse, self).__init__(content, **kwargs)


# 使用函数修饰器修改GET和POST请求
@api_view(['GET', 'POST'])
def BookInfoView(request):
    """
    列出所有的book信息，或创建一个新book。
    """
    if request.method == 'GET':
        print(request.query_params)
        books = BookInfo.objects.all()
        serializer = BookInfoSerializer(books, many=True)
        return JSONResponse(serializer.data)

    elif request.method == 'POST':
        # book = JSONParser().parse(request)
        # serializer = BookInfoSerializer(data=book)
        # 使用request.data自动将请求内容数据部分处理
        print(request.data)
        serializer = BookInfoSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return JSONResponse(serializer.data, status=201)
        return JSONResponse(serializer.errors, status=400)


@api_view(['GET', 'PUT', 'DELETE'])
def BookInfoDetailView(request, book_id):
    """
    获取，更新或删除一个指定ID的book。
    """
    try:
        book = BookInfo.objects.get(pk=book_id)
    except BookInfo.DoesNotExist:
        return JSONResponse(status=404)

    if request.method == 'GET':
        serializer = BookInfoSerializer(book)
        return JSONResponse(serializer.data)

    elif request.method == 'PUT':
        # data = JSONParser().parse(request)
        # serializer = BookInfoSerializer(book, data=data)
        # 使用request.data自动将请求内容数据部分处理
        serializer = BookInfoSerializer(book, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return JSONResponse(serializer.data)
        return JSONResponse(serializer.errors, status=400)

    elif request.method == 'DELETE':
        book.delete()
        return JSONResponse(status=204)
```


