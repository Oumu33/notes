# DNS服务配置
****

# 一、实验目的
1.  掌握缓存DNS服务、主DNS服务器、正向解析、反向解析、主从解析、子域授权、DNS转发器、访问控制、bind视图的相关操作

# 二、实验内容
1.  搭建一台缓存DNS服务器。

2.  搭建一台主DNS服务器，实现正向反向解析。

3.  搭建一台子域DNS服务器。

4.  搭建一台DNS转发器。

5.  实现访问控制、bind视图。

# 三、实验环境
1.  主DNS服务器mini centos7 ip为192.168.10.30

2.  从DNS服务器centos6 ip为192.168.10.20

3.  子域DNS服务器centos7克隆1 ip为192.168.10.10

4.  缓存DNS服务器有两块网卡，ip地址分别为192.168.10.100、10.10.64.225，并开启路由转发功能

5.  客户机1mini centos6 ip为192.168.10.40

6.  客户机2mini centos6克隆1 ip为10.10.64.212

# 四、实验分析与设计思路
1.   网络拓扑图

![](https://via.placeholder.com/800x600?text=Image+e5e65e83eb971ee1)

2.   实验思路

![](https://via.placeholder.com/800x600?text=Image+0f4f1584bbd064d4)

# 五、实验准备
1.   关闭所有主机防火墙

2.   测试网络连通性

3.   安装相关软件包

![](https://via.placeholder.com/800x600?text=Image+02e5bb6f5c9127a3)

# 六、正向解析
1.   配置主DNS服务器主配置文件

![](https://via.placeholder.com/800x600?text=Image+a8f091017367acae)

![](https://via.placeholder.com/800x600?text=Image+1d49a7c966879e21)

2.   配置主DNS服务器子配置文件

![](https://via.placeholder.com/800x600?text=Image+641f31e3650f39a9)

![](https://via.placeholder.com/800x600?text=Image+b11f8de7e45086e0)

3.   配置主DNS服务器区域配置文件

![](https://via.placeholder.com/800x600?text=Image+dd6d499c4d5e6e08)

![](https://via.placeholder.com/800x600?text=Image+3ff366d0cb8f2c7f)

4.   检查配置文件语法正确性

![](https://via.placeholder.com/800x600?text=Image+cf3fae336f8304e2)

5.   开启服务

![](https://via.placeholder.com/800x600?text=Image+94a126ca032832f7)

6.   查看端口状态

![](https://via.placeholder.com/800x600?text=Image+684af1fd134c5f12)

7.   客户机使用dig命令验证

![](https://via.placeholder.com/800x600?text=Image+7aec81c3794e379c)

# 七、反向解析
1.   配置主DNS服务器子配置文件

![](https://via.placeholder.com/800x600?text=Image+17b3aa38f44d9636)

2.   配置主DNS服务器反向解析区域配置文件

![](https://via.placeholder.com/800x600?text=Image+364a7253f9fe72da)

![](https://via.placeholder.com/800x600?text=Image+4376c5ddde04118a)

3.   客户机使用dig命令验证

![](https://via.placeholder.com/800x600?text=Image+34a92ce848172285)

# 八、主从解析
1.   配置从DNS服务器主配置文件

![](https://via.placeholder.com/800x600?text=Image+b94cae32e67338bb)

2.   配置从DNS服务器子配置文件

![](https://via.placeholder.com/800x600?text=Image+16febc3a02e55d11)

3.   配置主DNS服务器区域配置文件

![](https://via.placeholder.com/800x600?text=Image+8ab04ee573e7e365)

4.   客户机使用dig命令验证

![](https://via.placeholder.com/800x600?text=Image+71e1aad94ec9f5e3)

# 九、子域授权
1.   配置主DNS服务器区域配置文件

![](https://via.placeholder.com/800x600?text=Image+8cfb2f2f7f43bd38)

2.   配置子域DNS服务器子配置文件

![](https://via.placeholder.com/800x600?text=Image+73e0866600f57715)

3.   配置子域DNS服务器区域配置文件

![](https://via.placeholder.com/800x600?text=Image+711af82bc34a3676)

4.   客户机使用dig命令验证

![](https://via.placeholder.com/800x600?text=Image+67b253d8840600b4)

l  父域服务器可以解析子域，子域服务器不能解析父域

# 十、DNS转发器
1.   配置DNS转发器主配置文件（设置为缓存DNS服务器）

![](https://via.placeholder.com/800x600?text=Image+6f67515e87cdc8ae)

2.   配置主DNS服务器主配置文件

![](https://via.placeholder.com/800x600?text=Image+58663ae9ad59681c)

3.   配置子域DNS服务器子配置文件

![](https://via.placeholder.com/800x600?text=Image+f4d61a7f8cfafeb5)

4.   客户机使用dig命令验证

![](https://via.placeholder.com/800x600?text=Image+521b40806a3a89d5)

![](https://via.placeholder.com/800x600?text=Image+6adf75a348a03d5a)

# 十一、        访问控制
1.   配置主DNS服务器主配置文件

![](https://via.placeholder.com/800x600?text=Image+0d59084635285eba)

![](https://via.placeholder.com/800x600?text=Image+0d6bc01911a92ff9)

2.   客户机使用dig命令验证

①   默认允许任何主机递归，外网主机可以使用DNS递归查询

![](https://via.placeholder.com/800x600?text=Image+e2b4cf81fff8563f)

②   设置ACL后，内网主机仍然可以递归，外网主机不能递归

![](https://via.placeholder.com/800x600?text=Image+39041831e20437e8)

# 十二、        Bind视图
1.   配置主DNS服务器主配置文件（剪切根部分zone文件）

![](https://via.placeholder.com/800x600?text=Image+66db1613d10cfd23)

2.   配置主DNS服务器子配置文件

![](https://via.placeholder.com/800x600?text=Image+a77ff37a17d2b5b9)

![](https://via.placeholder.com/800x600?text=Image+386cb109aad387a4)

![](https://via.placeholder.com/800x600?text=Image+f561b6c7d1facabb)

3.   配置主DNS服务器区域配置文件

![](https://via.placeholder.com/800x600?text=Image+84ae02fa55643fbf)

4.   客户机使用dig命令验证

![](https://via.placeholder.com/800x600?text=Image+f4b3e622a27fb14f)

![](https://via.placeholder.com/800x600?text=Image+9bd6a6ffed3e4e2d)

# 十三、        实验总结
## 1.   中继路由配置
![](https://via.placeholder.com/800x600?text=Image+fb81d946a1b089df)


