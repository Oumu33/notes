# 系统备份-备份命令
# 一、dump命令
1. [root@localhost ~]#      dump [选项] 备份之后的文件名 原文件或目录
2. 选项：

| -level：  | 就是我们说的0-9十个备份级别 |
| --- | --- |
| -f 文件名：  | 指定备份之后的文件名 |
| -u：  | 备份成功之后，把备份时间记录在/etc/dumpdates文件 |
| -v：  | 显示备份过程中更多的输出信息 |
| -j：  | 调用bzlib库压缩备份文件，其实就是把备份文件压缩为.bz2格式，默认压缩等级是2 |
| -W：  | 显示允许被dump的分区的备份等级及备份时间备份分区 |


# 二、备份分区
1. 先执行一次完全备份，并压缩和更新备份时间
+ dump -0uj -f      /root/boot.bak.bz2 /boot/
2. 查看备份时间文件
+ cat /etc/dumpdates
3. 复制日志文件到/boot分区
+ cp install.log      /boot/
4. 增量备份/boot分区，并压缩
+ dump -1uj -f      /root/boot.bak1.bz2 /boot/
5. 查询分区的备份时间及备份级别的
+ dump –W

# 三、备份文件或目录
1. 完全备份/etc/目录，只能使用0级别进行完全备份，而<font style="color:red;">不再支持增量备份</font>
+ dump -0j -f      /root/etc.dump.bz2 /etc/

# 四、restore命令
1. [root@localhost ~]#      restore [模式选项] [选项]
2. 模式选项：restore命令常用的模式有以下四种，这四个模式<font style="color:red;">不能混用。</font>

| -C： | 比较备份数据和实际数据的变化 |
| --- | --- |
| -i：  | 进入交互模式，手工选择需要恢复的文件。 |
| -t：  | 查看模式，用于查看备份文件中拥有哪些数据。 |
| -r：  | 还原模式，用于数据还原。 |


1. 选项：
+ -f：      指定备份文件的文件名

# 五、比较备份数据和实际数据的变化
1. 把/boot目录中内核镜像文件改个名字
+ mv     /boot/vmlinuz-2.6.32-279.el6.i686 /boot/vmlinuz-2.6.32-279.el6.i686.bak
2. restore发现内核镜像文件丢失
+ restore -C -f      /root/boot.bak.bz2

# 六、查看模式
1. restore -t -f      boot.bak.bz2

# 七、还原模式
#还原boot.bak.bz2分区备份

#先还原完全备份的数据

mkdir boot.test

cd boot.test/

restore -r -f /root/boot.bak.bz2

#解压缩

restore -r -f /root/boot.bak1.bz2

#恢复增量备份数据

#还原/etc/目录的备份etc.dump.bz2

restore -r -f etc.dump.bz2

#还原etc.dump.bz2备份

 


