# NTP与定时任务
# NTP时钟同步与定时任务
## 设置系统时间
date -s 2018-08-31

date -s 12:12:12

date -s "2018-08-31 15:15:15"

## 设置硬件时钟：
hwclock --set --date "2016-01-15 15:58:00"        

系统时间-->同步到-->硬件时间：hwclock -w（参数是被同步的）

硬件时间-->同步到-->系统时间：hwclock -s

## 系统时间与硬件时钟同步
hwclock --hctosys(--systohc)

## 通过NTP同步系统时钟
vim /etc/ntp.conf

server ntpdate time2.aliyun.com prefer

service ntpd stop/start

iptables -F

ntpdate time2.aliyun.com(或者加-u更新,-d调试参数)

# 用户的crontab设置
## crontab选项
| -e： | 编辑crontab定时任务 |
| --- | --- |
| -l：  | 查询crontab任务 |
| -r：  | 删除当前用户所有的crontab任务 |


## crontab编辑界面
[root@localhost ~]#      crontab -e#进入crontab编辑界面。会打开vim编辑你的工作。

![](../../images/img_3850.png)

## 命令格式
* * * * * 执行的任务

| 项目  | 含义  | 范围 |
| --- | --- | --- |
| 第一个“*”  | 一小时当中的第几**分钟** | 0-59 |
| 第二个“*”  | 一天当中的第几**小时** | 0-23 |
| 第三个“*”  | 一个月当中的第几**天** | 1-31 |
| 第四个“*”  | 一年当中的第几**月 ** | 1-12 |
| 第五个“*”  | 一周当中的**星期**几  | 0-7（0和7都代表星期日） |


| 时间  | 含义 |
| --- | --- |
| 45 22 * *   *  | 命令 在22点45分执行命令 |
| 0 17 * * 1    | 命令   每周1 的17点0分执行命令 |
| 0 5 1,15 *   *  | 命令   每月1号和15号的凌晨5点0分执行命令 |
| 40 4 * *   1-5  | 命令   每周一到周五的凌晨4点40分执行命令 |
| */10 4 * *   *  | 命令   每天的凌晨4点，每隔10分钟执行一次命令 |
| 0 0 1,15 *   1  | 命令   每月1号和15号，每周1的0点0分都会执行命令。注意：星期几和几号最好不要同时出现，因为他们定义的都是天。非常容易让管理员混乱。 |


|  特殊符号  | 含义 |
| --- | --- |
| *  | 代表任何时间。比如第一个“*”就代表一小时中每分钟都执行一次的意思。 |
| ，  | 代表不连续的时间。比如“0 8,12,16 * * * 命令”，就代表在每天的8点0分，12点0分，16点0分都执行一次命令 |
| -  | 代表连续的时间范围。比如“0 5 * * 1-6命令”，代表在周一到周六的凌晨5点0分执行命令 |
| */n  | 代表每隔多久执行一次。比如“*/10 * * * * 命令”，代表每隔10分钟就执行一遍命令 |


## 示例
```bash
● 每隔一个小时的第一分钟运行
1 0,2,4,6,8,10,12,14,16,18,20,22 * * *
● 每个星期一和每月16日正午运行
* 12 16 * 1
● 周一至周五执行
* * * * 1-5
● 每月12,14,16,18日执行
* * 12,14,16,18 * *
* * 12-18/2
```

 

