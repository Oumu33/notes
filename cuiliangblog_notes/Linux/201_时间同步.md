# 时间同步

> 来源: Linux
> 创建时间: 2024-10-06T01:19:47+08:00
> 更新时间: 2026-01-11T09:43:20.775989+08:00
> 阅读量: 180 | 点赞: 0

---

> ubuntu默认使用<font style="color:rgb(77, 77, 77);">systemd-timesyncd服务实现时间同步。</font>
>

# 检查服务状态
```bash
root@ubuntu20:~# timedatectl
               Local time: Sat 2024-10-05 17:18:59 UTC
           Universal time: Sat 2024-10-05 17:18:59 UTC
                 RTC time: Sat 2024-10-05 17:18:59
                Time zone: Etc/UTC (UTC, +0000)
System clock synchronized: yes # 如果时钟不同步，会显示为no 
              NTP service: active
          RTC in local TZ: no
root@ubuntu20:~# systemctl status systemd-timesyncd.service
● systemd-timesyncd.service - Network Time Synchronization
     Loaded: loaded (/usr/lib/systemd/system/systemd-timesyncd.service; 
enabled; preset: enabled)
     Active: active (running) since Sat 2024-10-05 16:49:35 UTC; 32min ago
       Docs: man:systemd-timesyncd.service(8)
   Main PID: 625 (systemd-timesyn)
     Status: "Contacted time server 185.125.190.56:123 (ntp.ubuntu.com)."
      Tasks: 2 (limit: 4557)
     Memory: 1.5M (peak: 2.0M)
        CPU: 151ms
     CGroup: /system.slice/systemd-timesyncd.service
             └─625 /usr/lib/systemd/systemd-timesyncd

Oct 05 16:49:35 ubuntu20 systemd[1]: Starting systemd-timesyncd.service - Network Time Synchronization...
Oct 05 16:49:35 ubuntu20 systemd[1]: Started systemd-timesyncd.service - Network Time Synchronization.
Oct 05 16:49:35 ubuntu20 systemd-timesyncd[625]: Network configuration changed, trying to establish connection.
Oct 05 16:49:50 ubuntu20 systemd-timesyncd[625]: Network configuration changed, trying to establish connection.
Oct 05 16:50:22 ubuntu20 systemd-timesyncd[625]: Contacted time server 185.125.190.56:123 (ntp.ubuntu.com).
Oct 05 16:50:22 ubuntu20 systemd-timesyncd[625]: Initial clock synchronization to Sat 2024-10-05 16:50:22.559566 UTC.
```

# 启用时间同步
```bash
timedatectl set-ntp true
```

# 设置ntp源服务器
## 修改配置文件
```bash
root@ubuntu20:~# cat /etc/systemd/timesyncd.conf 
#  This file is part of systemd.
#
#  systemd is free software; you can redistribute it and/or modify it under the
#  terms of the GNU Lesser General Public License as published by the Free
#  Software Foundation; either version 2.1 of the License, or (at your option)
#  any later version.
#
# Entries in this file show the compile time defaults. Local configuration
# should be created by either modifying this file (or a copy of it placed in
# /etc/ if the original file is shipped in /usr/), or by creating "drop-ins" in
# the /etc/systemd/timesyncd.conf.d/ directory. The latter is generally
# recommended. Defaults can be restored by simply deleting the main
# configuration file and all drop-ins located in /etc/.
#
# Use 'systemd-analyze cat-config systemd/timesyncd.conf' to display the full config.
#
# See timesyncd.conf(5) for details.

[Time]
NTP=ntp1.aliyun.com ntp.neu.edu.cn
#FallbackNTP=ntp.ubuntu.com
#RootDistanceMaxSec=5
#PollIntervalMinSec=32
#PollIntervalMaxSec=2048
#ConnectionRetrySec=30
#SaveIntervalSec=60
```

## 重启服务
```bash
root@ubuntu20:~# systemctl restart systemd-timesyncd.service
```

# 修改时区
```bash
root@ubuntu20:~# timedatectl set-timezone Asia/Shanghai
root@ubuntu20:~# date
Sun Oct  6 01:27:40 CST 2024
root@ubuntu20:~# timedatectl
               Local time: Sun 2024-10-06 01:27:46 CST
           Universal time: Sat 2024-10-05 17:27:46 UTC
                 RTC time: Sat 2024-10-05 17:27:46
                Time zone: Asia/Shanghai (CST, +0800)
System clock synchronized: yes
              NTP service: active
          RTC in local TZ: no
```

除此之外也可以使用chrony 实现时间同步，具体可参考[https://www.cuiliangblog.cn/detail/section/31516177](https://www.cuiliangblog.cn/detail/section/31516177)


